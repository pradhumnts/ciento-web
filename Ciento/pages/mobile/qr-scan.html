<!DOCTYPE html>

<html lang="en">
  <head>
    <base href="" />
    <meta charset="utf-8" />
    <title>Ciento</title>
    <meta name="description" content="Updates and statistics" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <link rel="icon" type="image/png" href="../../assets/media/Ciento_R3 yellow.png"/>

    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700"
    />
    <!--end::Page Vendors Styles-->

    <!--begin::Global Theme Styles(used by all pages)-->
    <link
      href="../../assets/plugins/global/plugins.bundle.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="../../assets/plugins/custom/prismjs/prismjs.bundle.css"
      rel="stylesheet"
      type="text/css"
    />
    <script type="text/javascript" src="instascan.min.js"></script>
    <link href="../../assets/css/style.bundle.css" rel="stylesheet" type="text/css" />
    <script src="https://rawgit.com/schmich/instascan-builds/master/instascan.min.js"></script>
    <!-- <script src="../../assets/js/scripts.bundle.js"></script> -->
    <link rel="stylesheet" href="../../assets/css/ciento.css" />
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <!--end::Global Theme Styles-->
    <link rel="stylesheet" href="../../assets/js/instascan.min.js" />
  </head>
  <body id="kt_body" class="page-loading">
    <!-- <div class="loading-wrapper">
      <div id="loading"></div>
  </div> -->
        <div class="qr-code d-flex justify-content-center flex-column align-items-center h-100 position-relative">  
            <div class="qr-wrapper pt-0">
              <video id="preview" class="qr-scanner w-100"></video>
            </div>
        <div class="overlay-content d-flex justify-content-center align-items-center h-100 w-100">
        <h3 class="w-75 text-white text-center">Align the QR code within the frame to scan</h3>
        <div class="timer position-absolute">
          <div class="d-flex align-items-center justify-content-center">
            <i class="far fa-clock font-size-h3 text-white"></i>
            <p class="font-size-h3 mb-0 ml-3 text-white" id="qr-timer"></p>
          </div>
          <a href="#" onclick="window.history.back()"><button class="btn btn-light font-weight-bold text-primary my-10 opacity-50">Cancel Scanning</button></a>
        </div>
        </div> 
        <img src="../../assets/media/QR/qr-overlay.png" class="qr-svg" alt="">
          <!-- <svg class="qr-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 427.998 926.003">
            <path id="Subtraction_1" data-name="Subtraction 1" d="M-19177,1789h-428l0-926h428v926h0v0Zm-349-644a20.02,20.02,0,0,0-19.994,20v271a20.02,20.02,0,0,0,19.994,20h271a20.024,20.024,0,0,0,20-20V1165a20.024,20.024,0,0,0-20-20Z" transform="translate(19605 -862.999)" opacity="0.66"/>
          </svg> -->
          
      </div>
     
      <div class="btn-group btn-group-toggle mb-5" data-toggle="buttons">
        <label class="btn btn-primary active">
          <input type="radio" name="options" value="1" autocomplete="off" checked> Front Camera
        </label>
        <label class="btn btn-secondary">
          <input type="radio" name="options" value="2" autocomplete="off"> Back Camera
        </label>
      </div>
    <script type="text/javascript">
      // $(document).ready(function(){
             
      //           $(window).on('load', function() {
      //             $('.loading-wrapper').fadeOut('slow');
      //         })
      //       });
      var scanner = new Instascan.Scanner({ video: document.getElementById('preview'), scanPeriod: 5, mirror: true });
      scanner.addListener('scan',function(content){
        alert(content);
      });
      Instascan.Camera.getCameras().then(function (cameras){
        if(cameras.length>0){
          scanner.start(cameras[0]);
          $('[name="options"]').on('change',function(){
            if($(this).val()==1){
              if(cameras[0]!=""){
                scanner.start(cameras[0]);
              }else{
                alert('No Front camera found!');
              }
            }else if($(this).val()==2){
              if(cameras[1]!=""){
                scanner.start(cameras[1]);
              }else{
                alert('No Back camera found!');
              }
            }
          });
        }else{
          console.error('No cameras found.');
          alert('No cameras found.');
        }
      }).catch(function(e){
        console.error(e);
        alert(e);
      });

      // qr timer
      var timeleft = 15;
      var downloadTimer = setInterval(function(){
        if(timeleft <= 0){
          clearInterval(downloadTimer);
          window.history.back();
        } else {
          document.getElementById("qr-timer").innerHTML = timeleft + "s";
        }
        timeleft -= 1;
      }, 1000);
    </script>
   
</body>
</html>